{"version":3,"sources":["webpack:///./src/app/core/auth/_guards/permission.guard.ts","webpack:///./src/app/core/auth/_services/club-tree.service.ts"],"names":[],"mappings":"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","file":"app-views-pages-user-management-user-management-module.js","sourcesContent":["// Angular\r\nimport { Injectable } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot } from '@angular/router';\r\n// RxJS\r\nimport { Observable } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\n// NGRX\r\nimport { select, Store } from '@ngrx/store';\r\n// Auth reducers and selectors\r\nimport { AppState} from '../../../core/reducers/';\r\nimport {PermissionsService} from '../../../core/auth/_services/permissions.service'\r\nimport {UserService} from '../../../core/auth/_services/-user.service'\r\nimport { permissionsReducer } from '../_reducers/permission.reducers';\r\n@Injectable()\r\n\r\n\r\nexport class PermissionGuard implements CanActivate {\r\n    \r\n    constructor(private store: Store<AppState>, private router: Router,private permission:PermissionsService,private user:UserService) { }\r\n\r\n    canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): any{\r\n        const moduleName = route.data['title'] as string;\r\n  let permissions = JSON.parse(localStorage.getItem('user'))['allPrivilidge'];\r\n  console.log(moduleName,permissions,this.permission['Roles'])\r\n        if( ! this.checked())\r\n        {\r\n            \r\n            this.router.navigateByUrl('/error/403');\r\n        }\r\n        else \r\n        {\r\n            if(moduleName=='roles')\r\n            {\r\n              if(! this.checkedPermission(permissions['Roles']) )\r\n              this.router.navigateByUrl('/error/403');\r\n              if(! permissions['Roles']['Get Roles'] )\r\n              this.router.navigateByUrl('/error/403');\r\n\r\n            }\r\n            else if(moduleName=='users')\r\n            {\r\n                if(! this.checkedPermission(['Users Mangement']))\r\n                this.router.navigateByUrl('/error/403');\r\n                if(! permissions['Users Mangement']['Get All Users'])\r\n                this.router.navigateByUrl('/error/403');\r\n            }\r\n            else if(moduleName=='invitations')\r\n            {\r\n                if(!permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403'); \r\n                if(!permissions['Users Mangement']['Invitation'])\r\n                this.router.navigateByUrl('/error/403'); \r\n            }\r\n            else if (moduleName=='editUser')\r\n            {\r\n                  this.user.currentUser.subscribe(res=>{\r\n                      if(!res)\r\n                      {\r\n                      this.router.navigateByUrl('user-management/users')\r\n                      }\r\n                  })\r\n                  if(! permissions['Users Mangement'])\r\n                  this.router.navigateByUrl('/error/403')\r\n                  if(! permissions['Users Mangement']['Update User'])\r\n                  this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if (moduleName=='setting')\r\n            {\r\n                if(! permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Users Mangement']['Setting'])\r\n                this.router.navigateByUrl('/error/403')\r\n\r\n            }\r\n            else if(moduleName=='addUser')\r\n            {\r\n                if(! permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Users Mangement']['Create User'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if(moduleName=='clubtree')\r\n            {\r\n                if(! permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Users Mangement']['Get All Users'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if(moduleName=='activities')\r\n            {\r\n                if(! permissions['Activities'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Activities']['Get Activities'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if(moduleName=='packages')\r\n            {\r\n                if(! permissions['Membership'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Membership']['Get Membership'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n        }\r\n           \r\n            return true;\r\n        \r\n    }\r\nchecked()\r\n{\r\n    let length=0\r\n    if(localStorage.getItem('user'))\r\n    {\r\n    Object.values(JSON.parse(localStorage.getItem('user'))['allPrivilidge']).forEach(function(elem){\r\n        length +=Object.values(elem).length \r\n        console.log(Object.values(elem).length )   \r\n    })\r\n   \r\n    }\r\n    return length;\r\n}\r\ncheckedPermission(object)\r\n{\r\n\r\n    let length=0\r\n    if(object)\r\n    {\r\n    \r\n    Object.values(object).forEach(function(elem){\r\n        length +=Object.values(elem).length \r\n        console.log(Object.values(elem).length )   \r\n    })\r\n   \r\n    }\r\n    return length;\r\n}\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { PublicMethods } from '../../_public/-public-methods'\r\nimport { UserService } from '../../auth/_services'\r\nimport { HttpClient } from '@angular/common/http'\r\nimport {publicService} from '../../auth/_services/public.service'\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ClubTreeService {\r\n  _url = PublicMethods.createURL\r\n\r\n  constructor(private http: HttpClient, private user: UserService,private publicservice:publicService) { }\r\n  getUnitsData() {\r\n    console.log(this.publicservice)\r\n  \r\n    return this.http.get(this._url('customers', 'getClubTree', ''))\r\n  }\r\n\r\n  //method to get data of a branch \r\n    getBranchData(pub_key) {\r\n    \r\n    return this.http.get(this._url('customers', 'getBranchData', pub_key))\r\n  }\r\n\r\n  //method to get data of a unit\r\n  getUnitData(pub_key) {\r\n    return this.http.get(this._url('customers', 'getUnitsData', pub_key))\r\n  }\r\n  //method to get data of a resource\r\n  getResourceData(id) {\r\n   \r\n    return this.http.get(this._url('unitresources', 'getResourceById', id))\r\n  }\r\n\r\n  //update\r\n  //edit data of branch\r\n  updateBranchData(branch) {\r\n    \r\n    return this.http.patch(this._url('customers', 'updateBranchData', branch['pub_key']), branch)\r\n\r\n\r\n  }\r\n  //edit data of unit\r\n  updateUnitData(unit) {\r\n    console.log(unit)\r\n   \r\n    return this.http.patch(this._url('customers', 'updateBranchData', unit['pub_key']), unit)\r\n\r\n  }\r\n  // edit data of \r\n  updateResourceData(resource) {\r\n    console.log(resource)\r\n    \r\n    return this.http.patch(this._url('unitresources', 'updateResource', resource['_id']), resource)\r\n\r\n  }\r\n  //delete\r\n  DeleteBranch(pub_key) {\r\n    \r\n    return this.http.delete(this._url('customers', 'deleteBranch', pub_key))\r\n  }\r\n  DeleteUnit(pub_key) {\r\n    \r\n    return this.http.delete(this._url('customers', 'deleteUnits', pub_key))\r\n\r\n  }\r\n  DeleteResource(id) {\r\n   \r\n    return this.http.delete(this._url('unitresources', 'deleteResource', id))\r\n\r\n  }\r\n  addBranch(branch) {\r\n    console.log(branch)\r\n   \r\n    return this.http.post(this._url('customers', 'addBranch', ''), branch)\r\n  }\r\n  addUnits(unit) {\r\n   \r\n    return this.http.post(this._url('customers', 'addUnits', ''), unit)\r\n\r\n  }\r\n  addResources(resource) {\r\n    \r\n    return this.http.post(this._url('unitresources', 'addResource', ''), resource)\r\n  }\r\n\r\n\r\n}\r\n"],"sourceRoot":""}
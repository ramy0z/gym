{"version":3,"sources":["webpack:///./src/app/core/auth/_guards/permission.guard.ts"],"names":[],"mappings":"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","file":"app-views-pages-user-settings-user-settings-module.js","sourcesContent":["// Angular\r\nimport { Injectable } from '@angular/core';\r\nimport { ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot } from '@angular/router';\r\n// RxJS\r\nimport { Observable } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\n// NGRX\r\nimport { select, Store } from '@ngrx/store';\r\n// Auth reducers and selectors\r\nimport { AppState} from '../../../core/reducers/';\r\nimport {PermissionsService} from '../../../core/auth/_services/permissions.service'\r\nimport {UserService} from '../../../core/auth/_services/-user.service'\r\nimport { permissionsReducer } from '../_reducers/permission.reducers';\r\n@Injectable()\r\n\r\n\r\nexport class PermissionGuard implements CanActivate {\r\n    \r\n    constructor(private store: Store<AppState>, private router: Router,private permission:PermissionsService,private user:UserService) { }\r\n\r\n    canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): any{\r\n        const moduleName = route.data['title'] as string;\r\n  let permissions = JSON.parse(localStorage.getItem('user'))['allPrivilidge'];\r\n  console.log(moduleName,permissions,this.permission['Roles'])\r\n        if( ! this.checked())\r\n        {\r\n            \r\n            this.router.navigateByUrl('/error/403');\r\n        }\r\n        else \r\n        {\r\n            if(moduleName=='roles')\r\n            {\r\n              if(! this.checkedPermission(permissions['Roles']) )\r\n              this.router.navigateByUrl('/error/403');\r\n              if(! permissions['Roles']['Get Roles'] )\r\n              this.router.navigateByUrl('/error/403');\r\n\r\n            }\r\n            else if(moduleName=='users')\r\n            {\r\n                if(! this.checkedPermission(['Users Mangement']))\r\n                this.router.navigateByUrl('/error/403');\r\n                if(! permissions['Users Mangement']['Get All Users'])\r\n                this.router.navigateByUrl('/error/403');\r\n            }\r\n            else if(moduleName=='invitations')\r\n            {\r\n                if(!permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403'); \r\n                if(!permissions['Users Mangement']['Invitation'])\r\n                this.router.navigateByUrl('/error/403'); \r\n            }\r\n            else if (moduleName=='editUser')\r\n            {\r\n                  this.user.currentUser.subscribe(res=>{\r\n                      if(!res)\r\n                      {\r\n                      this.router.navigateByUrl('user-management/users')\r\n                      }\r\n                  })\r\n                  if(! permissions['Users Mangement'])\r\n                  this.router.navigateByUrl('/error/403')\r\n                  if(! permissions['Users Mangement']['Update User'])\r\n                  this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if (moduleName=='setting')\r\n            {\r\n                if(! permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Users Mangement']['Setting'])\r\n                this.router.navigateByUrl('/error/403')\r\n\r\n            }\r\n            else if(moduleName=='addUser')\r\n            {\r\n                if(! permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Users Mangement']['Create User'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if(moduleName=='clubtree')\r\n            {\r\n                if(! permissions['Users Mangement'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Users Mangement']['Get All Users'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if(moduleName=='activities')\r\n            {\r\n                if(! permissions['Activities'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Activities']['Get Activities'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n            else if(moduleName=='packages')\r\n            {\r\n                if(! permissions['Membership'])\r\n                this.router.navigateByUrl('/error/403')\r\n                if(! permissions['Membership']['Get Membership'])\r\n                this.router.navigateByUrl('/error/403')\r\n            }\r\n        }\r\n           \r\n            return true;\r\n        \r\n    }\r\nchecked()\r\n{\r\n    let length=0\r\n    if(localStorage.getItem('user'))\r\n    {\r\n    Object.values(JSON.parse(localStorage.getItem('user'))['allPrivilidge']).forEach(function(elem){\r\n        length +=Object.values(elem).length \r\n        console.log(Object.values(elem).length )   \r\n    })\r\n   \r\n    }\r\n    return length;\r\n}\r\ncheckedPermission(object)\r\n{\r\n\r\n    let length=0\r\n    if(object)\r\n    {\r\n    \r\n    Object.values(object).forEach(function(elem){\r\n        length +=Object.values(elem).length \r\n        console.log(Object.values(elem).length )   \r\n    })\r\n   \r\n    }\r\n    return length;\r\n}\r\n\r\n}\r\n"],"sourceRoot":""}